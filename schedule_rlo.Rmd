
```{r Tabellen generieren, include = FALSE}

library(dplyr)
library(httr)
library(xml2)
library(rvest)
library(data.table)
library(lubridate)
library(mgsub)
library(knitr)
library(RWordPress)
library(xtable)
library(kableExtra)



#HTML Seite einlesen und lesbar machen
rlo <- GET("http://baseballaustria.com/regionalliga-ost/")

rlo <- read_html(rlo)

#Tabllen rausholen und in datatable umwandeln
standings <- html_nodes(rlo, "table")[1]
schedule <- html_nodes(rlo, "table")[2]

schedule <- html_table(schedule)

schedule <- rbindlist(schedule)

#####Spielplan aufbereiten##########
#Auf Rohrbach filtern
schedule <- schedule[Home == "Rohrbach Crazy Geese" | Away == "Rohrbach Crazy Geese"]

#Datum und Uhrzeit rausholen
schedule[, Datum := strptime(Date, format = '%Y-%m-%d %H:%M:%S')]
schedule$Datum <- format(schedule$Datum, "%d.%m.%Y")

schedule[, Beginn := strptime(Date, format = '%Y-%m-%d %H:%M:%S')]
schedule$Beginn <- format(schedule$Beginn, "%H:%M")

#Spielort kÃ¼rzen
schedule[Field %like% "Rohrbach", Field := "Rohrbach"]
schedule[Field %like% "Schwechat", Field := "Rannersdorf"]
schedule[Field %like% "Spenadlwiese", Field := "Spenadlwiese - Wien"]
schedule[Field %like% "Schrems", Field := "Schrems"]

#Mannschaften kÃ¼rzen
schedule <- as.data.table(lapply(schedule, function(x) {
                  mgsub(x, c("Rohrbach Crazy Geese", "Schwechat Blue Bats"), c("Crazy Geese", "Blue Bats"))
              }))

#Vektor wo Ergebnisse vorliegen
ergebnisse <- grepl(" - ", schedule$`Time/Results`)

schedule[ergebnisse, Ergebnis := `Time/Results`]
schedule[!ergebnisse, Ergebnis := " - "]

#endgÃ¼ltige Tabellen generien. Einmal groÃ fÃ¼r Hauptseite. Einmal fÃ¼r Widget
schedule <- select(schedule, Datum, Beginn, Gast = Away, Heim = Home, Spielort = Field, Ergebnis)

#Vektor um anzuzeigen welche Reihen wir blau haben wollen
blue_rows <- which(schedule$Spielort %in% "Rohrbach")

schedule_format <- kable(schedule, align = c("c","c", "c","c","c", "c")) %>%
  kable_styling(bootstrap_options = c("responsive")) %>%
  row_spec(blue_rows, color = "#01023C")

```

**Regular Season**

```{r Tabelle anzeigen , echo = FALSE}
schedule_format
```

**Heimspiele sind blau markiert**
